---
title: "Investigating Data Exfiltration with Splunk, Palo Alto, and Threat Intelligence Tools"
datePublished: Wed Nov 05 2025 19:04:18 GMT+0000 (Coordinated Universal Time)
cuid: cmhmd9sw1000202l496mtbx27
slug: investigating-data-exfiltration-with-splunk-palo-alto-and-threat-intelligence-tools
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1762369416588/9c0b5108-1f20-40f1-8da0-ce95851268ad.png

---

**By:** Ashish ‚Äî SOC Analyst, Louisiana State University Shreveport

---

## üß© Overview

Data exfiltration remains one of the most serious threats a security operations center (SOC) can face. It involves unauthorized transfer of sensitive data from internal systems to external destinations ‚Äî often through stealthy, encrypted channels or cloud-based applications.

In this blog, I‚Äôll walk through how to investigate potential exfiltration activity using **Splunk**, **Palo Alto firewall logs**, and **threat intelligence tools** such as **VirusTotal**, **AbuseIPDB**, and **Spur,** and so on.

---

## üîç Step 1: Initial Detection in Splunk

The first step in detecting data exfiltration is identifying **unusual outbound network activity**. Splunk‚Äôs **Network Traffic data model** provides a great starting point. Using a simple `tstats` query, we can summarize traffic volume and isolate sources sending unusually large amounts of data externally.

### Example Splunk Query

```plaintext
| tstats summariesonly=t
    sum(All_Traffic.bytes_in) as bytes_in 
    sum(All_Traffic.bytes_out) as bytes_out
    values(All_Traffic.transport) as transport
    count
    from datamodel=Network_Traffic.All_Traffic 
    where All_Traffic.src="*" All_Traffic.dest="*" All_Traffic.transport="*"
    by _time, All_Traffic.action, All_Traffic.src, All_Traffic.dest, All_Traffic.dest_port 
    span=5m
| `drop_dm_object_name("All_Traffic")` 
| eval MB_in=round(bytes_in/pow(1024,2),2)
| eval MB_out=round(bytes_out/pow(1024,2),2)
| sort - count 
| fields _time,action,src,dest,dest_port,transport,MB_in,MB_out,count
```

This query helps analysts:

* Identify top sources and destinations of network traffic
    
* Visualize outbound vs inbound volume over time
    
* Detect spikes that could indicate data transfer anomalies
    

---

## üî• Step 2: Deep Dive with Palo Alto Firewall Logs

After spotting suspicious traffic, the next step is **correlating firewall logs** to confirm what exactly happened. Palo Alto logs can provide critical context ‚Äî such as session actions, ports, and applications in use.

### Example Query

```plaintext
`ts_paloalto_standard_indexes` src=* dest=*
```

This query filters traffic from a suspected internal host to an external destination. Reviewing **session end reasons**, **application types**, and **NAT traversal patterns (UDP 4500)** can help determine whether the activity was a legitimate VPN connection or potential exfiltration.

---

## üß† Step 3: Context from Threat Intelligence

Once IPs or domains of interest are identified, enrichment through **threat intelligence** is essential. Tools such as:

* üîπ **VirusTotal** ‚Äî to check for known malicious infrastructure
    
* üîπ **AbuseIPDB** ‚Äî to assess reported abuse history
    
* üîπ [**Spur.us**](http://Spur.us) ‚Äî to verify VPN, proxy, or anonymizer usage
    

These insights reveal whether the destination is linked to suspicious behavior, compromised servers, or anonymizing services often used in exfiltration.

---

## üßæ Step 4: Identity Correlation with Entra ID & Defender

Cross-referencing user identities and device telemetry helps determine **who initiated the transfer**. Using **Microsoft Entra ID** sign-in logs and **Microsoft Defender** alerts, analysts can confirm if the activity originated from a known user session or potentially compromised credentials.

---

## üß∞ Step 5: Validation and Response

Finally, investigators should validate findings through **endpoint correlation** (EDR, DHCP logs, or MAC address mapping) to identify the affected host. Running a **full EDR scan** ensures no malicious binaries or exfiltration tools are present.

If the host shows unexpected outbound transfers and the destination is marked risky, the incident should be **escalated for containment** and **data loss assessment**.

---

## ‚öôÔ∏è Recommended Workflow

1. Use **Splunk tstats** queries for baseline traffic analysis
    
2. Correlate with **Palo Alto firewall logs**
    
3. Enrich IOC data with **VirusTotal**, **AbuseIPDB**, and **Spur**
    
4. Validate identity and endpoint data via **Entra ID** and **Defender**
    
5. Escalate incidents based on correlation and reputation results
    

---

## üí° Key Takeaway

Data exfiltration investigations rely on **multi-source correlation** blending SIEM analytics, firewall visibility, EDR insights, and threat intelligence. A single data point rarely tells the full story, but together they uncover the who, what, and how behind an incident.

By applying structured queries, enrichment, and validation, SOC teams can transform a simple network alert into a complete picture of potential compromise ‚Äî and act before damage is done.

---

#CyberSecurity #Splunk #SOAR #PaloAlto #MicrosoftDefender #EntraID #VirusTotal #AbuseIPDB #ThreatHunting #IncidentResponse #DataExfiltration #BlueTeam #SOC #LSUS